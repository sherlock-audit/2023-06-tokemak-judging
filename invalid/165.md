Blunt Inky Yeti

high

# SafeERC20.safeApprove reverts for changing existing approvals
## Summary
`SafeERC20.safeApprove` reverts when a non-zero approval is changed to a non-zero approval. There are some instances in the `tokemak` contracts that try to change an existing approval to a non-zero value which will revert.

## Vulnerability Detail
The safeApprove function has explicit warning:
```solidity
        // safeApprove should only be called when setting an initial allowance,
        // or when resetting it to zero. To increase and decrease it, use
        // 'safeIncreaseAllowance' and 'safeDecreaseAllowance'
```

- https://github.com/sherlock-audit/2023-06-tokemak/blob/main/v2-core-audit-2023-07-14/src/vault/DestinationVault.sol#L272
- https://github.com/sherlock-audit/2023-06-tokemak/blob/main/v2-core-audit-2023-07-14/src/swapper/adapters/BalancerV2Swap.sol#L62
- https://github.com/sherlock-audit/2023-06-tokemak/blob/main/v2-core-audit-2023-07-14/src/swapper/adapters/CurveV1StableSwap.sol#L48
- https://github.com/sherlock-audit/2023-06-tokemak/blob/main/v2-core-audit-2023-07-14/src/swapper/adapters/CurveV2Swap.sol#L42
- https://github.com/sherlock-audit/2023-06-tokemak/blob/main/v2-core-audit-2023-07-14/src/swapper/adapters/UniV3Swap.sol#L54
- https://github.com/sherlock-audit/2023-06-tokemak/blob/main/v2-core-audit-2023-07-14/src/vault/libs/LMPDebt.sol#L327
- https://github.com/sherlock-audit/2023-06-tokemak/blob/main/v2-core-audit-2023-07-14/src/utils/PeripheryPayments.sol#L35

## Impact
For above example, impact is that user withdrawal transaction will get reverted.
- https://github.com/sherlock-audit/2023-06-tokemak/blob/main/v2-core-audit-2023-07-14/src/vault/DestinationVault.sol#L272

## Code Snippet

## Tool used
Manual Review

## Recommendation
Consider using 'LibAdapter.sol._approve'.